<!DOCTYPE html>
<html>
  <head>
    <title>Mapa con Marcadores desde Firestore</title>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
      import {
        getFirestore,
        collection,
        getDocs,
      } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";

      // Configuración de Firestore
      const firebaseConfig = {
        apiKey: "AIzaSyA94W_iBzKYoglvT8BK3sh96ydkMLdLqsI",
        projectId: "venezuelalibre9e",
      };

      // Inicializar Firestore
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      // Función para inicializar el mapa
      async function initMap() {
        const map = new google.maps.Map(document.getElementById("map"), {
          center: { lat: 8.0, lng: -66.0 }, // Centro inicial del mapa (Venezuela)
          zoom: 6,
        });

        // Leer documentos de la colección "markers" en Firestore
        const querySnapshot = await getDocs(collection(db, "markers"));
        querySnapshot.forEach((doc) => {
          const data = doc.data();

          // Crear marcador para cada documento
          const marker = new google.maps.Marker({
            position: { lat: data.lat, lng: data.lng },
            map,
            title: data.title,
          });

          // Agregar una ventana de información
          const infoWindow = new google.maps.InfoWindow({
            content: `<h3>${data.title}</h3><p>${data.content}</p>`,
          });

          // Abrir la ventana de información al hacer clic en el marcador
          marker.addListener("click", () => {
            infoWindow.open(map, marker);
          });
        });
      }

      // Exponer initMap al objeto global
      window.initMap = initMap;
    </script>
    <style>
      /* Estilos básicos */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
      }
    </style>
  </head>
  <body>
    <!-- Contenedor del mapa -->
    <div id="map"></div>

    <!-- Carga la API de Google Maps -->
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA94W_iBzKYoglvT8BK3sh96ydkMLdLqsI&callback=initMap"
      defer
    ></script>
  </body>
</html>